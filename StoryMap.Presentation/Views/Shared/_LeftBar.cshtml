<div class="col-md-3" style="padding-left: 10px; padding-right: 0px;">
    <div class="leftbar">
        <!-- Maps List -->
        <div class="card mb-3">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#mapsCollapse" role="button" aria-expanded="false" aria-controls="mapsCollapse">
                <strong>Maps</strong> <span class="icon ms-auto"> &gt; </span>
            </div>
            <div class="collapse" id="mapsCollapse">
                <div class="list-group list-group-flush">
                    <!-- Loop through maps (10 for testing) -->
                    @for (int i = 1; i <= 10; i++)
                    {
                        <a href="#" class="list-group-item list-group-item-action ps-3" data-bs-toggle="collapse" data-bs-target="#mapCollapse@i" role="button" aria-expanded="false" aria-controls="mapCollapse@i">
                            Map @i <span class="icon ms-auto"> &gt; </span>
                        </a>
                        <div class="collapse" id="mapCollapse@i">
                            <ul class="list-unstyled ms-3">
                                @for (int img = 1; img <= 3; img++) 
                                {
                                    <li>Image @img</li>
                                }
                            </ul>
                        </div>
                    }
                    <!-- Last item is Add Image -->
                    <a href="#" class="list-group-item list-group-item-action ps-3">Add Image</a>
                </div>
            </div>
        </div>

        <!-- Chapters List -->
        <div class="card mb-3">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#chaptersCollapse" role="button" aria-expanded="false" aria-controls="chaptersCollapse">
                <strong>Chapters</strong> <span class="icon ms-auto"> &gt; </span>
            </div>
            <div class="collapse" id="chaptersCollapse">
                <div class="list-group list-group-flush">
                    <!-- Loop through chapters (5 for testing) -->
                    @for (int j = 1; j <= 5; j++)
                    {
                        <a href="#" class="list-group-item list-group-item-action ps-3" data-bs-toggle="collapse" data-bs-target="#chapterCollapse@j" role="button" aria-expanded="false" aria-controls="chapterCollapse@j">
                            Chapter @j <span class="icon ms-auto"> &gt; </span>
                        </a>
                        <div class="collapse" id="chapterCollapse@j">
                            <ul class="list-unstyled ms-3">
                                <!-- Loop through timeframes (5 for each chapter) -->
                                @for (int k = 1; k <= 5; k++)
                                {
                                    <li>Timeframe @k</li>
                                }
                            </ul>
                        </div>
                    }
                    <!-- Last item is Add Timeframe -->
                    <a href="#" class="list-group-item list-group-item-action ps-3">Add Timeframe</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Custom Styling for LeftBar -->
<style>
    /* Left sidebar styling */
    .leftbar {
        background-color: #e3f2fd; /* Match the navbar background */
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Shadow for floating effect */
        position: fixed; /* Fixed position ensures it stays in place */
        top: 130px; /* Start 130px from the top (just below the navbar) */
        bottom: 20px; /* Extend it to the bottom of the viewport */
        left: 20px; /* 20px from the left margin */
        width: 230px; /* Sidebar width */
        height: calc(100vh - 150px); /* Ensure it takes full height from navbar to bottom */
        z-index: 1050; /* Ensure it stays on top of other elements */
        overflow-y: auto; /* Allow scrolling if content exceeds sidebar height */
    }

    /* Right sidebar styling */
    .rightbar {
        background-color: #e3f2fd; /* Match the navbar background */
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Shadow for floating effect */
        margin-left: 10px;
        margin-bottom: 20px;
    }

    /* Adjust the font size of the heading */
    .leftbar h5, .rightbar h5 {
        font-size: 1.25rem;
        font-weight: bold;
    }

    /* Card header and body styles */
    .card-header {
        background-color: #e3f2fd; /* Match the navbar background */
        border-bottom: 2px solid #bbb;
        display: flex;
        align-items: center;
    }

    .card-header .icon {
        font-size: 1.2rem;
        margin-left: auto;
        transform: rotate(90deg); /* Rotate the icon */
        transition: transform 0.3s ease; /* Animate the icon */
    }

    .card-header.collapsed .icon {
        transform: rotate(0deg); /* Rotate back when collapsed */
    }

    .card-body button {
        font-size: 0.875rem;
        font-weight: bold;
    }

    /* List item styling */
    .list-group-item {
        border: none; /* Remove borders for all list items */
        padding-left: 20px; /* Slight indentation */
    }

    .list-group-item-action:hover {
        background-color: #b3e0ff; /* Hover effect */
    }

    /* Nested lists inside items (for images and timeframes) */
    .list-unstyled {
        padding-left: 20px;
    }

    /* Nested list items */
    .list-unstyled li {
        padding-left: 10px; /* Slight nesting */
    }

</style>

<!-- Initialize Bootstrap Collapse -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize all collapses (but do not automatically show)
        var collapseElements = document.querySelectorAll('.collapse');
        collapseElements.forEach(function (el) {
            new bootstrap.Collapse(el, {
                toggle: false // Prevent auto-toggle on page load
            });
        });

        // Add event listener to each toggle trigger
        document.querySelectorAll('[data-bs-toggle="collapse"]').forEach(function (trigger) {
            trigger.addEventListener('click', function (event) {
                // Prevent default action (e.g., jumping to the link)
                event.preventDefault();
                
                // Get the target collapse ID from the clicked element's data-bs-target
                var targetId = event.currentTarget.getAttribute('data-bs-target');
                
                // Find the collapse element to toggle
                var targetCollapse = document.querySelector(targetId);

                // Toggle the specific collapse item
                var collapseInstance = new bootstrap.Collapse(targetCollapse);
                collapseInstance.toggle(); // This method ensures it toggles only that collapse
            });
        });
    });
</script>
